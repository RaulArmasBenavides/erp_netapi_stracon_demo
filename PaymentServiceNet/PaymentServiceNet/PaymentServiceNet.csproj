<Project Sdk="Microsoft.NET.Sdk.Web">

  <PropertyGroup>
    <TargetFramework>net8.0-windows7.0</TargetFramework>
    <Nullable>disable</Nullable>
    <ImplicitUsings>enable</ImplicitUsings>
    <UserSecretsId>c0a8807a-1daa-4d8b-8003-3d4d576d6ee7</UserSecretsId>
    <DockerDefaultTargetOS>Linux</DockerDefaultTargetOS>
  </PropertyGroup>

  <ItemGroup>
    <PackageReference Include="Asp.Versioning.Mvc" Version="8.1.1" />
    <PackageReference Include="Asp.Versioning.Mvc.ApiExplorer" Version="8.1.1" />
    <PackageReference Include="AutoMapper" Version="12.0.1" />
    <PackageReference Include="AutoMapper.Extensions.Microsoft.DependencyInjection" Version="12.0.1" />
    <PackageReference Include="Microsoft.AspNetCore.Authentication.JwtBearer" Version="7.0.8" />
    <PackageReference Include="Microsoft.AspNetCore.Identity.EntityFrameworkCore" Version="7.0.11" />
    <PackageReference Include="Microsoft.EntityFrameworkCore.SqlServer" Version="7.0.11" />
    <PackageReference Include="Microsoft.EntityFrameworkCore.Tools" Version="7.0.11">
      <PrivateAssets>all</PrivateAssets>
      <IncludeAssets>runtime; build; native; contentfiles; analyzers; buildtransitive</IncludeAssets>
    </PackageReference>
    <PackageReference Include="Microsoft.Extensions.DependencyInjection" Version="7.0.0" />
    <PackageReference Include="Microsoft.VisualStudio.Azure.Containers.Tools.Targets" Version="1.22.1" />
    <PackageReference Include="Serilog.AspNetCore" Version="7.0.0" />
    <PackageReference Include="StyleCop.Analyzers" Version="1.1.118">
      <PrivateAssets>all</PrivateAssets>
      <IncludeAssets>runtime; build; native; contentfiles; analyzers; buildtransitive</IncludeAssets>
    </PackageReference>
    <PackageReference Include="Swashbuckle.AspNetCore" Version="6.5.0" />
  </ItemGroup>

  <ItemGroup>
    <ProjectReference Include="..\PaymentServiceNet.Application\PaymentServiceNet.Application.csproj" />
    <ProjectReference Include="..\PaymentServiceNet.Core\PaymentServiceNet.Core.csproj" />
    <ProjectReference Include="..\PaymentServiceNet.CrossCutting\PaymentServiceNet.CrossCutting.csproj" />
  </ItemGroup>
  <!-- Script Creado por RaÃºl Armas-->
  <Target Name="AssemblyVersion" BeforeTargets="CoreCompile" DependsOnTargets="PrepareForBuild">
    <PropertyGroup>
      <!-- Define Constants -->
      <AssemblyInfo>$(IntermediateOutputPath)$(MSBuildProjectName).AssemblyInfo$(DefaultLanguageSourceExtension)</AssemblyInfo>
      <AssemblyInfoContent>$([System.IO.File]::ReadAllText($(AssemblyInfo)))</AssemblyInfoContent>
      <AssemblyFileRegex>\[assembly: System.Reflection.AssemblyFileVersionAttribute\(.(\d+)\.(\d+)\.(\d+)\.(\d+)....</AssemblyFileRegex>
      <AssemblyFile>[assembly: System.Reflection.AssemblyFileVersionAttribute("$([System.DateTime]::Now.ToString("yyyy.M.d.HHmm"))")]</AssemblyFile>
      <AssemblyInformationalRegex>\[assembly: System.Reflection.AssemblyInformationalVersionAttribute\(.(\d+)\.(\d+)\.(\d+)\+</AssemblyInformationalRegex>
      <AssemblyInformational>[assembly: System.Reflection.AssemblyInformationalVersionAttribute("$([System.DateTime]::Now.ToString("yyyy.M.d.HHmm"))+</AssemblyInformational>
      <AssemblyVersionRegex>\[assembly: System.Reflection.AssemblyVersionAttribute\(.(\d+)\.(\d+)\.(\d+)\.(\d+)....</AssemblyVersionRegex>
      <AssemblyVersion>[assembly: System.Reflection.AssemblyVersionAttribute("$([System.DateTime]::Now.ToString("yyyy.M.d.HHmm"))")]</AssemblyVersion>
    </PropertyGroup>
    <!-- Escribir versionamiento en archivo AssemblyInfo -->
    <WriteLinesToFile File="$(AssemblyInfo)" Lines="$([System.Text.RegularExpressions.Regex]::Replace($([System.Text.RegularExpressions.Regex]::Replace($([System.Text.RegularExpressions.Regex]::Replace($(AssemblyInfoContent), $(AssemblyFileRegex), $(AssemblyFile))), $(AssemblyInformationalRegex), $(AssemblyInformational))), $(AssemblyVersionRegex), $(AssemblyVersion)))" Overwrite="true" />
  </Target>
</Project>
